################################################################################
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#      http://www.apache.org/licenses/LICENSE-2.0
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
################################################################################

- do: Logical Operators
  projection: |-
    id_, bool_
    bool_ OR TRUE AS comp_1
    bool_ OR FALSE AS comp_2
    bool_ AND TRUE AS comp_3
    bool_ AND FALSE AS comp_4
    NOT bool_ AS comp_5
    bool_ IS TRUE AS comp_6
    bool_ IS NOT TRUE AS comp_7
    bool_ IS FALSE AS comp_8
    bool_ IS NOT FALSE AS comp_9
  primary-key: id_
  non-null: 'true'
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`bool_` BOOLEAN 'George' 'false',`comp_1` BOOLEAN,`comp_2` BOOLEAN,`comp_3` BOOLEAN,`comp_4` BOOLEAN,`comp_5` BOOLEAN,`comp_6` BOOLEAN,`comp_7` BOOLEAN,`comp_8` BOOLEAN,`comp_9` BOOLEAN}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, true, true, true, true, false, false, true, false, false, true], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, true, true, true, true, false, false, true, false, false, true], after=[-1, false, true, false, false, false, true, false, true, true, false], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, false, true, false, false, false, true, false, true, true, false], after=[], op=DELETE, meta=()}
- do: Logical Operators With Null
  projection: |-
    id_, bool_
    bool_ OR TRUE AS comp_1
    bool_ OR FALSE AS comp_2
    bool_ AND TRUE AS comp_3
    bool_ AND FALSE AS comp_4
    NOT bool_ AS comp_5
    bool_ IS TRUE AS comp_6
    bool_ IS NOT TRUE AS comp_7
    bool_ IS FALSE AS comp_8
    bool_ IS NOT FALSE AS comp_9
  primary-key: id_
  expect-error: 'java.lang.RuntimeException: Failed to evaluate projection expression `$0 || false` for column `comp_2` in table `foo.bar.baz`.'
