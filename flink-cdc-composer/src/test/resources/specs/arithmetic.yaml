################################################################################
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#      http://www.apache.org/licenses/LICENSE-2.0
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
################################################################################

- do: Add Op
  projection: |-
    id_
    tinyint_ + 1 AS comp_1
    smallint_ + 1 AS comp_2
    int_ + 1 AS comp_3
    bigint_ + 1 AS comp_4
    float_ + 1 AS comp_5
    double_ + 1 AS comp_6
  non-null: 'true'
  primary-key: id_
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` INT,`comp_2` INT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 3, 4, 5, 6, 8.7, 89.88], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 3, 4, 5, 6, 8.7, 89.88], after=[-1, -1, -2, -3, -4, -6.7, -87.88], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -1, -2, -3, -4, -6.7, -87.88], after=[], op=DELETE, meta=()}
- do: Subtract Op
  projection: |-
    id_
    tinyint_ - 1 AS comp_1
    smallint_ - 1 AS comp_2
    int_ - 1 AS comp_3
    bigint_ - 1 AS comp_4
    float_ - 1 AS comp_5
    double_ - 1 AS comp_6
  primary-key: id_
  non-null: 'true'
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` INT,`comp_2` INT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 1, 2, 3, 4, 6.7, 87.88], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 1, 2, 3, 4, 6.7, 87.88], after=[-1, -3, -4, -5, -6, -8.7, -89.88], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -3, -4, -5, -6, -8.7, -89.88], after=[], op=DELETE, meta=()}
- do: Multiply Op
  projection: |-
    id_
    tinyint_ * 2 AS comp_1
    smallint_ * 2 AS comp_2
    int_ * 2 AS comp_3
    bigint_ * 2 AS comp_4
    float_ * 2 AS comp_5
    double_ * 2 AS comp_6
  primary-key: id_
  non-null: 'true'
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` INT,`comp_2` INT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 4, 6, 8, 10, 15.4, 177.76], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 4, 6, 8, 10, 15.4, 177.76], after=[-1, -4, -6, -8, -10, -15.4, -177.76], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -4, -6, -8, -10, -15.4, -177.76], after=[], op=DELETE, meta=()}
- do: Divide Op
  projection: |-
    id_
    tinyint_ / 2 AS comp_1
    smallint_ / 2 AS comp_2
    int_ / 2 AS comp_3
    bigint_ / 2 AS comp_4
    float_ / 2 AS comp_5
    double_ / 2 AS comp_6
  primary-key: id_
  non-null: 'true'
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` INT,`comp_2` INT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 1, 1, 2, 2, 3.85, 44.44], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 1, 1, 2, 2, 3.85, 44.44], after=[-1, -1, -1, -2, -2, -3.85, -44.44], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -1, -1, -2, -2, -3.85, -44.44], after=[], op=DELETE, meta=()}
- do: Mod Op
  projection: |-
    id_
    tinyint_ % 2 AS comp_1
    smallint_ % 2 AS comp_2
    int_ % 2 AS comp_3
    bigint_ % CAST(2 AS BIGINT) AS comp_4
  primary-key: id_
  non-null: 'true'
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` INT,`comp_2` INT,`comp_3` INT,`comp_4` BIGINT}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 0, 1, 0, 1], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 0, 1, 0, 1], after=[-1, 0, -1, 0, -1], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, 0, -1, 0, -1], after=[], op=DELETE, meta=()}
- do: Abs Op
  projection: |-
    id_
    ABS(tinyint_) AS comp_1
    ABS(smallint_) AS comp_2
    ABS(int_) AS comp_3
    ABS(bigint_) AS comp_4
    ABS(float_) AS comp_5
    ABS(double_) AS comp_6
  primary-key: id_
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` TINYINT,`comp_2` SMALLINT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 2, 3, 4, 5, 7.7, 88.88], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 2, 3, 4, 5, 7.7, 88.88], after=[-1, 2, 3, 4, 5, 7.7, 88.88], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, 2, 3, 4, 5, 7.7, 88.88], after=[], op=DELETE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[0, null, null, null, null, null, null], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[0, null, null, null, null, null, null], after=[], op=DELETE, meta=()}
- do: Ceil Op
  projection: |-
    id_
    CEIL(tinyint_) AS comp_1
    CEIL(smallint_) AS comp_2
    CEIL(int_) AS comp_3
    CEIL(bigint_) AS comp_4
    CEIL(float_) AS comp_5
    CEIL(double_) AS comp_6
  primary-key: id_
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` TINYINT,`comp_2` SMALLINT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 2, 3, 4, 5, 8.0, 89.0], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 2, 3, 4, 5, 8.0, 89.0], after=[-1, -2, -3, -4, -5, -7.0, -88.0], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -2, -3, -4, -5, -7.0, -88.0], after=[], op=DELETE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[0, null, null, null, null, null, null], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[0, null, null, null, null, null, null], after=[], op=DELETE, meta=()}
- do: Floor Op
  projection: |-
    id_
    FLOOR(tinyint_) AS comp_1
    FLOOR(smallint_) AS comp_2
    FLOOR(int_) AS comp_3
    FLOOR(bigint_) AS comp_4
    FLOOR(float_) AS comp_5
    FLOOR(double_) AS comp_6
  primary-key: id_
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` TINYINT,`comp_2` SMALLINT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 2, 3, 4, 5, 7.0, 88.0], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 2, 3, 4, 5, 7.0, 88.0], after=[-1, -2, -3, -4, -5, -8.0, -89.0], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -2, -3, -4, -5, -8.0, -89.0], after=[], op=DELETE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[0, null, null, null, null, null, null], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[0, null, null, null, null, null, null], after=[], op=DELETE, meta=()}
- do: Round Op
  projection: |-
    id_
    ROUND(tinyint_, 1) AS comp_1
    ROUND(smallint_, 1) AS comp_2
    ROUND(int_, 1) AS comp_3
    ROUND(bigint_, 1) AS comp_4
    ROUND(float_, 1) AS comp_5
    ROUND(double_, 1) AS comp_6
  primary-key: id_
  expect: |-
    CreateTableEvent{tableId=foo.bar.baz, schema=columns={`id_` BIGINT NOT NULL 'Identifier',`comp_1` TINYINT,`comp_2` SMALLINT,`comp_3` INT,`comp_4` BIGINT,`comp_5` FLOAT,`comp_6` DOUBLE}, primaryKeys=id_, options=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[1, 2, 3, 4, 5, 7.7, 88.9], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[1, 2, 3, 4, 5, 7.7, 88.9], after=[-1, -2, -3, -4, -5, -7.7, -88.9], op=UPDATE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[-1, -2, -3, -4, -5, -7.7, -88.9], after=[], op=DELETE, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[], after=[0, null, null, null, null, null, null], op=INSERT, meta=()}
    DataChangeEvent{tableId=foo.bar.baz, before=[0, null, null, null, null, null, null], after=[], op=DELETE, meta=()}
- do: Add Op With Null
  ignore: FLINK-38905
  projection: |-
    id_
    tinyint_ + 1 AS comp_1
    smallint_ + 1 AS comp_2
    int_ + 1 AS comp_3
    bigint_ + 1 AS comp_4
    float_ + 1 AS comp_5
    double_ + 1 AS comp_6
- do: Subtract Op With Null
  ignore: FLINK-38905
  projection: |-
    id_
    tinyint_ - 1 AS comp_1
    smallint_ - 1 AS comp_2
    int_ - 1 AS comp_3
    bigint_ - 1 AS comp_4
    float_ - 1 AS comp_5
    double_ - 1 AS comp_6
- do: Multiply Op With Null
  ignore: FLINK-38905
  projection: |-
    id_
    tinyint_ * 2 AS comp_1
    smallint_ * 2 AS comp_2
    int_ * 2 AS comp_3
    bigint_ * 2 AS comp_4
    float_ * 2 AS comp_5
    double_ * 2 AS comp_6
- do: Divide Op With Null
  ignore: FLINK-38905
  projection: |-
    id_
    tinyint_ / 2 AS comp_1
    smallint_ / 2 AS comp_2
    int_ / 2 AS comp_3
    bigint_ / 2 AS comp_4
    float_ / 2 AS comp_5
    double_ / 2 AS comp_6
- do: Mod Op With Null
  ignore: FLINK-38905
  projection: |-
    id_
    tinyint_ % 2 AS comp_1
    smallint_ % 2 AS comp_2
    int_ % 2 AS comp_3
    bigint_ % 2 AS comp_4
